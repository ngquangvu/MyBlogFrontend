---
import { t } from "i18next";
import { Icon } from "astro-icon";
import type { FooterLink } from "~/types";
import ContactForm from "./ContactForm";

// const CONTACT_API = fetch(`${import.meta.env.CONTACT_API}/contact`);
const CONTACT_API = (await import.meta.env.CONTACT_API) + "contact";

const links: Array<FooterLink> = [
  {
    url: "https://github.com/ngquangvu",
    description: "View source on GitHub",
    icon: "fa-brands:github",
    disable: false,
  },
  {
    url: "https://www.facebook.com/valkyzone",
    description: "Facebook",
    icon: "fa-brands:facebook",
    disable: false,
  },
  {
    url: "https://www.instagram.com/ngquangvu/",
    description: "Instagram",
    icon: "fa-brands:instagram",
    disable: false,
  },
  {
    url: "https://linkedin.com",
    description: "Linkedin",
    icon: "fa-brands:linkedin",
    disable: true,
  },
];
---

<div
  id="contact"
  class="relative isolate bg-black border rounded-lg border-gray-400"
>
  <!-- <div class="bg-white p-2">
        <ContactForm client:visible contactUrl={CONTACT_API} />
    </div> -->

  <div class="mx-auto grid max-w-7xl grid-cols-1 lg:grid-cols-2">
    <div
      class="relative flex flex-col justify-between px-6 pb-8 pt-16 lg:static lg:px-8"
    >
      <div class="mx-auto max-w-[100%] lg:mx-0 lg:max-w-lg">
        <div
          class="absolute inset-y-0 left-0 -z-10 w-full overflow-hidden ring-1 ring-white/5 lg:w-1/2"
        >
          <div
            class="absolute -left-56 top-[calc(100%-13rem)] transform-gpu blur-3xl lg:left-[max(-14rem,calc(100%-59rem))] lg:top-[calc(50%-7rem)]"
            aria-hidden="true"
          >
            <div
              class="aspect-[1155/678] w-[72.1875rem] bg-gradient-to-br from-green-500 to-blue-500 opacity-20"
              style={{
                clipPath:
                  "polygon(74.1% 56.1%, 100% 38.6%, 97.5% 73.3%, 85.5% 100%, 80.7% 98.2%, 72.5% 67.7%, 60.2% 37.8%, 52.4% 32.2%, 47.5% 41.9%, 45.2% 65.8%, 27.5% 23.5%, 0.1% 35.4%, 17.9% 0.1%, 27.6% 23.5%, 76.1% 2.6%, 74.1% 56.1%)",
              }}
            >
            </div>
          </div>
        </div>
        <h2 class="text-3xl font-bold tracking-tight text-white">
          {}
        </h2>
        <p
          class="mt-6 text-base leading-8 text-gray-300"
          set:html={t(`contact.content`)}
        />
        <dl class="mt-10 space-y-4 text-base leading-7 text-gray-300">
          <div class="flex gap-x-2 items-center">
            <dt class="flex-none">
              <span class="sr-only">Name</span>
              <Icon name="ph:user-bold" class="h-6 w-6" />
            </dt>
            <dd>{t(`contact.name`)}</dd>
          </div>
          <div class="flex gap-x-2 items-center">
            <dt class="flex-none">
              <span class="sr-only">Address</span>
              <Icon name="octicon:location-16" class="h-6 w-6" />
            </dt>
            <dd>{t(`contact.address`)}</dd>
          </div>
          <div class="flex gap-x-2 items-center">
            <dt class="flex-none">
              <span class="sr-only">Telephone</span>
              <Icon name="ic:outline-phone" class="h-6 w-6" />
            </dt>
            <dd>
              <a class="hover:text-white break-all" href="tel:84903306600">
                +84 90 330 6600
              </a>
            </dd>
          </div>
          <div class="flex gap-x-2 items-center">
            <dt class="flex-none">
              <span class="sr-only">Email</span>
              <Icon name="ic:outline-mail" class="h-6 w-6" />
            </dt>
            <dd>
              <a
                class="hover:text-white break-all"
                href="javascript:linkTo_UnCryptMailto('nbjmup;ohvzforvbohwv/xpslAhnbjm/dpn');"
                >nguyenquangvu.work@gmail.com</a
              >
            </dd>
          </div>
        </dl>
      </div>
      <div>
        <ul class="w-full flex flex-wrap justify-start gap-4 mt-6 md:mt-2">
          {
            links.map((link) => (
              <li>
                <a
                  class={`flex h-12 w-12 hover:opacity-60 items-center justify-center p-2 ${
                    link.disable &&
                    "cursor-default hover:opacity-100 pointer-events-none opacity-50"
                  }`}
                  href={link.url}
                  target="_blank"
                >
                  <span class="sr-only">{link.description}</span>
                  <Icon class="h-full text-white" name={link.icon} />
                </a>
              </li>
            ))
          }
        </ul>
      </div>
    </div>
    <form action="#" method="POST" class="px-6 pb-10 pt-16 lg:px-8">
      <div class="mx-auto max-w-xl lg:mr-0 lg:max-w-lg">
        <div class="grid grid-cols-1 gap-x-8 gap-y-6 sm:grid-cols-2">
          <div>
            <label
              for="first-name"
              class="block text-sm font-semibold leading-6 text-white"
            >
              {t(`contact.form first name`)}
            </label>
            <div class="mt-2.5">
              <input
                type="text"
                name="first-name"
                id="first-name"
                autocomplete="given-name"
                class="block w-full rounded-md border-0 bg-white/5 px-3.5 py-2 text-white shadow-sm ring-1 ring-inset ring-white/10 sm:text-sm sm:leading-6"
              />
            </div>
          </div>
          <div>
            <label
              for="last-name"
              class="block text-sm font-semibold leading-6 text-white"
            >
              {t(`contact.form last name`)}
            </label>
            <div class="mt-2.5">
              <input
                type="text"
                name="last-name"
                id="last-name"
                autocomplete="family-name"
                class="block w-full rounded-md border-0 bg-white/5 px-3.5 py-2 text-white shadow-sm ring-1 ring-inset ring-white/10 sm:text-sm sm:leading-6"
              />
            </div>
          </div>
          <div class="sm:col-span-2">
            <label
              for="email"
              class="block text-sm font-semibold leading-6 text-white"
            >
              {t(`contact.form email`)}
            </label>
            <div class="mt-2.5">
              <input
                type="email"
                name="email"
                id="email"
                autocomplete="email"
                class="block w-full rounded-md border-0 bg-white/5 px-3.5 py-2 text-white shadow-sm ring-1 ring-inset ring-white/10 sm:text-sm sm:leading-6"
              />
            </div>
          </div>
          <div class="sm:col-span-2">
            <label
              for="phone-number"
              class="block text-sm font-semibold leading-6 text-white"
            >
              {t(`contact.form phone`)}
            </label>
            <div class="mt-2.5">
              <input
                type="tel"
                name="phone-number"
                id="phone-number"
                autocomplete="tel"
                class="block w-full rounded-md border-0 bg-white/5 px-3.5 py-2 text-white shadow-sm ring-1 ring-inset ring-white/10 sm:text-sm sm:leading-6"
              />
            </div>
          </div>
          <div class="sm:col-span-2">
            <label
              for="message"
              class="block text-sm font-semibold leading-6 text-white"
            >
              {t(`contact.form message`)}
            </label>
            <div class="mt-2.5">
              <textarea
                name="message"
                id="message"
                rows={4}
                class="block w-full rounded-md border-0 bg-white/5 px-3.5 py-2 text-white shadow-sm ring-1 ring-inset ring-white/10 sm:text-sm sm:leading-6"
              ></textarea>
            </div>
          </div>
        </div>
        <div class="mt-8 flex justify-end">
          <button
            type="submit"
            class="pointer-events-none border-2 opacity-60 border-teal-500 text-teal-500 hover:bg-teal-500 hover:text-white duration-500 px-3.5 py-2.5 text-center text-sm font-semibold shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"
          >
            {t(`contact.form send`)}
          </button>
        </div>
      </div>
    </form>
  </div>
</div>

<script is:inline type="text/javascript">
function UnCryptMailto(s) {
  var n = 0;
  var r = "";
  for (var i = 0; i < s.length; i++) {
    n = s.charCodeAt(i);
    if (n >= 8364) {
      n = 128;
    }
    r += String.fromCharCode(n - 1);
  }
  return r;
}

function linkTo_UnCryptMailto(s) {
  location.href = UnCryptMailto(s);
}
</script>
